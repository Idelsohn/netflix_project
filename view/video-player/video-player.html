<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player - Netflix</title>
    <link rel="stylesheet" href="video-player.css">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading video...</div>
    </div>

    <!-- Continue Watching Modal -->
    <div id="continueModal" class="continue-modal hidden">
        <div class="modal-content">
            <h3>Continue Watching?</h3>
            <p>You stopped watching at <span id="continueTime"></span></p>
            <div class="modal-buttons">
                <button id="continueBtn" class="continue-btn">Continue</button>
                <button id="restartBtn" class="restart-btn">Start Over</button>
            </div>
        </div>
    </div>

    <!-- Video Player Container -->
    <div id="videoPlayerContainer" class="video-player-container">
        <!-- Video Element -->
        <video id="mainVideo" class="video-element" preload="metadata">
            Your browser does not support the video tag.
        </video>

        <!-- Video Overlay Controls -->
        <div id="videoOverlay" class="video-overlay">
            <!-- Center Play Button -->
            <div id="centerPlayBtn" class="center-play-button">
                <button class="play-button-large">‚ñ∂</button>
            </div>

            <!-- Main Controls Bar -->
            <div id="controlsBar" class="controls-bar">
                <!-- Left Controls -->
                <div class="controls-left">
                    <button id="playPauseBtn" class="control-btn play-pause-btn">
                        <span class="play-icon">‚ñ∂</span>
                        <span class="pause-icon hidden">‚è∏</span>
                    </button>
                    <button id="skipBackBtn" class="control-btn skip-btn">
                        <span>‚è™ 10s</span>
                    </button>
                    <button id="skipForwardBtn" class="control-btn skip-btn">
                        <span>10s ‚è©</span>
                    </button>
                    <div class="volume-control">
                        <button id="volumeBtn" class="control-btn volume-btn">
                            <span class="volume-on">üîä</span>
                            <span class="volume-off hidden">üîá</span>
                        </button>
                        <div class="volume-slider-container">
                            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="50">
                        </div>
                    </div>
                    <div class="time-display">
                        <span id="timeDisplay">0:00</span>
                        <span class="time-separator">/</span>
                        <span id="durationDisplay">0:00</span>
                    </div>
                </div>

                <!-- Center Timeline -->
                <div class="controls-center">
                    <div class="timeline-container">
                        <div id="progressBar" class="timeline-track">
                            <div id="progressFilled" class="progress-bar"></div>
                            <div id="bufferBar" class="buffer-bar"></div>
                            <input type="range" id="timeline" class="timeline-slider" min="0" max="100" value="0">
                            <div id="timelineThumb" class="timeline-thumb"></div>
                            <div id="progressPreview" class="progress-preview hidden">0:00</div>
                        </div>
                    </div>
                </div>

                <!-- Right Controls -->
                <div class="controls-right">
                    <button id="episodeListBtn" class="control-btn episodes-btn">üìã</button>
                    <button id="nextEpisodeBtn" class="control-btn next-episode-btn hidden">Next Episode</button>
                    <button id="fullscreenBtn" class="control-btn fullscreen-btn">‚õ∂</button>
                </div>
            </div>
        </div>

        <!-- Episode Drawer -->
        <div id="episodeDrawer" class="episode-drawer hidden">
            <div class="drawer-content">
                <div class="drawer-header">
                    <div class="drawer-title-section">
                        <h3 id="seriesTitle">Episodes</h3>
                        <span id="episodeCounter" class="episode-counter"></span>
                    </div>
                    <button id="closeDrawer" class="close-drawer-btn">√ó</button>
                </div>
                <div class="current-episode-info">
                    <div class="current-episode-thumbnail">
                        <img id="currentEpisodeThumbnail" src="" alt="Current Episode">
                    </div>
                    <div class="current-episode-details">
                        <h4 id="currentEpisodeTitle"></h4>
                        <p id="currentEpisodeDescription"></p>
                    </div>
                </div>
                <div id="episodeList" class="episode-list">
                    <!-- Episodes will be loaded dynamically -->
                </div>
            </div>
        </div>
        <div class="drawer-overlay hidden"></div>

        <!-- Error Message -->
        <div id="errorMessage" class="error-message hidden">
            <div class="error-content">
                <h3>Video Error</h3>
                <p id="errorText">Failed to load video</p>
                <button id="retryBtn" class="retry-btn">Try Again</button>
                <button id="backToFeedBtn" class="back-btn">Back to Browse</button>
            </div>
        </div>

        <!-- Buffering Indicator -->
        <div id="bufferingIndicator" class="buffering-indicator hidden">
            <div class="spinner"></div>
            <div class="buffering-text">Buffering...</div>
        </div>
        <!-- Skip Feedback -->
        <div id="skipFeedback" class="skip-feedback hidden">
            <span class="skip-icon"></span>
            <span class="skip-text"></span>
        </div>

        <!-- Next Episode Countdown -->
        <div id="nextEpisodeCountdown" class="next-episode-countdown hidden">
            <div class="countdown-content">
                <h4>Next Episode</h4>
                <p class="next-episode-title"></p>
                <div class="countdown-timer-container">
                    <span>Playing in </span>
                    <span class="countdown-timer">10</span>
                    <span> seconds</span>
                </div>
                <div class="countdown-actions">
                    <button class="play-next-now">Play Now</button>
                    <button class="cancel-autoplay">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Back to Feed Button -->
    <button id="backButton" class="back-to-feed-button">
        <span>‚Üê</span> Back to Browse
    </button>

    <!-- JavaScript Files -->
    <script src="../utils.js"></script>
    <script type="module" src="../auth/auth.js"></script>
    <script type="module" src="video-controls.js"></script>
    <script type="module" src="episode-manager.js"></script>
    <script type="module" src="progress-sync.js"></script>
    <script type="module" src="video-player.js"></script>
</body>
</html>